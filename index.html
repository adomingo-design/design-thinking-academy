<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Design Thinking Academy</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- React 18 -->
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

  <!-- Babel -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- jsPDF (per generar PDF) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    .no-scrollbar::-webkit-scrollbar { display: none; }
    .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    .transition-all {
      transition-property: all;
      transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
      transition-duration: 150ms;
    }
  </style>
</head>

<body class="bg-slate-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState } = React;

    const ACADEMY_DATA = [
      {
        id: "empatia",
        title: "Fase 1: Empatitzar",
        description: "Entendre profundament les necessitats, dolors i motivacions dels usuaris.",
        videoUrl: "https://www.youtube.com/watch?v=J8QopxPGijU",
        tools: [
          {
            id: "mapa-empatia",
            name: "Mapa d'Empatia",
            desc: "Visualitza el que l'usuari diu, fa, pensa i sent.",
            content: "Eina de sÃ­ntesi per ajustar la proposta de valor."
          },
          {
            id: "buyer-persona",
            name: "Buyer Persona",
            desc: "Crea un perfil semi-fictici del teu client ideal.",
            content: "Ajuda a personificar el grup d'usuaris."
          }
        ]
      },
      {
        id: "definicio",
        title: "Fase 2: Definir",
        description: "Sintetitzar la informaciÃ³ per trobar el problema real.",
        videoUrl: "https://www.youtube.com/watch?v=Fs_n3g5mrvA",
        tools: [
          {
            id: "pov",
            name: "Point of View (POV)",
            desc: "Frase que defineix l'usuari i la necessitat.",
            content: "Estructura: [Usuari] necessita [Necessitat] perquÃ¨ [Insight]."
          },
          {
            id: "hmw",
            name: "How Might We (HMW)",
            desc: "Converteix problemes en oportunitats.",
            content: "Preguntes tipus 'Com podrÃ­em...?'"
          }
        ]
      },
      {
        id: "ideacio",
        title: "Fase 3: Idear",
        description: "Generar la major quantitat de solucions possibles.",
        videoUrl: "https://www.youtube.com/watch?v=OUrLyuxisSk",
        tools: [
          {
            id: "brainstorming",
            name: "Brainstorming",
            desc: "TÃ¨cnica grupal per idees massives.",
            content: "Fomentar la quantitat i suspendre el judici."
          },
          {
            id: "crazy-8",
            name: "Crazy 8's",
            desc: "Dibuixa 8 idees en 8 minuts.",
            content: "MÃ¨tode rÃ pid per forÃ§ar la ment."
          }
        ]
      },
      {
        id: "prototipado",
        title: "Fase 4: Prototipar",
        description: "Fer tangibles les idees per poder mostrar-les.",
        videoUrl: "https://www.youtube.com/watch?v=nf8cSBIO6QI",
        tools: [
          {
            id: "storyboard",
            name: "Storyboard",
            desc: "NarraciÃ³ visual de la soluciÃ³.",
            content: "ExperiÃ¨ncia de l'usuari en vinyetes."
          },
          {
            id: "prototipo-baja",
            name: "Prototip de Baixa Fidelitat",
            desc: "Models rÃ pids en paper o cartrÃ³.",
            content: "L'objectiu Ã©s fallar rÃ pid i barat."
          }
        ]
      },
      {
        id: "testeo",
        title: "Fase 5: Testejar",
        description: "Validar les solucions amb usuaris reals.",
        videoUrl: "https://www.youtube.com/watch?v=eRNeTYoLvN0",
        tools: [
          {
            id: "malla-receptora",
            name: "Malla Receptora",
            desc: "Quadrant per organitzar feedback.",
            content: "Coses interessants, crÃ­tiques, preguntes i idees."
          },
          {
            id: "test-usuario",
            name: "Proves d'Usuari",
            desc: "Observar l'usuari amb el prototip.",
            content: "Identifica friccions i millores."
          }
        ]
      }
    ];

    function App() {
      const [completedTools, setCompletedTools] = useState([]);
      const [activeTab, setActiveTab] = useState(ACADEMY_DATA[0].id);
      const [copiedId, setCopiedId] = useState(null);

      const totalTools = ACADEMY_DATA.reduce((acc, curr) => acc + curr.tools.length, 0);
      const progressPercent = Math.round((completedTools.length / totalTools) * 100);

      const toggleTool = (toolId) => {
        setCompletedTools(prev =>
          prev.includes(toolId)
            ? prev.filter(id => id !== toolId)
            : [...prev, toolId]
        );
      };

      const copyToClipboard = async (text, id) => {
        try {
          await navigator.clipboard.writeText(text);
        } catch (e) {
          const textArea = document.createElement("textarea");
          textArea.value = text;
          document.body.appendChild(textArea);
          textArea.select();
          document.execCommand("copy");
          document.body.removeChild(textArea);
        }
        setCopiedId(id);
        setTimeout(() => setCopiedId(null), 2000);
      };

      const activePhase = ACADEMY_DATA.find(p => p.id === activeTab);

      // âœ… BotÃ³ nou: descarregar PDF (progres + pendents)
      const downloadPDF = () => {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF({ unit: "mm", format: "a4" });

        const pageW = doc.internal.pageSize.getWidth();
        const pageH = doc.internal.pageSize.getHeight();
        const margin = 14;
        let y = 18;

        const today = new Date();
        const dateStr = today.toLocaleDateString("ca-ES", { year: "numeric", month: "2-digit", day: "2-digit" });

        const completedCount = completedTools.length;
        const pendingCount = totalTools - completedCount;

        const addHeader = () => {
          doc.setFillColor(79, 70, 229); // indigo
          doc.rect(0, 0, pageW, 22, "F");

          doc.setTextColor(255, 255, 255);
          doc.setFont("helvetica", "bold");
          doc.setFontSize(16);
          doc.text("Design Thinking Academy", margin, 14);

          doc.setFont("helvetica", "normal");
          doc.setFontSize(10);
          doc.text(`Informe de progres â€” ${dateStr}`, pageW - margin, 14, { align: "right" });

          doc.setTextColor(15, 23, 42); // slate-900
          y = 32;
        };

        const ensureSpace = (needed = 8) => {
          if (y + needed > pageH - margin) {
            doc.addPage();
            addHeader();
          }
        };

        const sectionTitle = (txt) => {
          ensureSpace(10);
          doc.setFont("helvetica", "bold");
          doc.setFontSize(12);
          doc.text(txt, margin, y);
          y += 7;
          doc.setDrawColor(226, 232, 240); // slate-200
          doc.line(margin, y, pageW - margin, y);
          y += 6;
        };

        const bullet = (txt) => {
          ensureSpace(7);
          doc.setFont("helvetica", "normal");
          doc.setFontSize(10);
          const maxW = pageW - margin * 2 - 4;
          const lines = doc.splitTextToSize(txt, maxW);
          doc.text("â€¢", margin, y);
          doc.text(lines, margin + 4, y);
          y += lines.length * 5 + 1;
        };

        addHeader();

        sectionTitle("Resum");
        doc.setFont("helvetica", "normal");
        doc.setFontSize(10);
        doc.text(`Progres total: ${progressPercent}%`, margin, y); y += 6;
        doc.text(`Completades: ${completedCount} / ${totalTools}`, margin, y); y += 6;
        doc.text(`Pendents: ${pendingCount}`, margin, y); y += 8;

        // Barra de progres
        ensureSpace(14);
        const barX = margin;
        const barY = y;
        const barW = pageW - margin * 2;
        const barH = 6;

        doc.setFillColor(241, 245, 249); // slate-100
        doc.roundedRect(barX, barY, barW, barH, 2, 2, "F");

        const fillW = Math.max(0, Math.min(barW, (progressPercent / 100) * barW));
        doc.setFillColor(79, 70, 229); // indigo
        doc.roundedRect(barX, barY, fillW, barH, 2, 2, "F");
        y += 14;

        sectionTitle("Tasques pendents per fase");

        let anyPending = false;
        ACADEMY_DATA.forEach((phase) => {
          const pendingTools = phase.tools.filter(t => !completedTools.includes(t.id));
          if (pendingTools.length === 0) return;

          anyPending = true;
          ensureSpace(8);
          doc.setFont("helvetica", "bold");
          doc.setFontSize(11);
          doc.text(phase.title, margin, y);
          y += 6;

          pendingTools.forEach((t) => bullet(t.name));
          y += 2;
        });

        if (!anyPending) {
          ensureSpace(10);
          doc.setFont("helvetica", "normal");
          doc.setFontSize(10);
          doc.text("No tens tasques pendents. Tot completat! ðŸŽ‰", margin, y);
          y += 6;
        }

        // Peu de pagina
        ensureSpace(14);
        doc.setDrawColor(226, 232, 240);
        doc.line(margin, pageH - 18, pageW - margin, pageH - 18);
        doc.setFont("helvetica", "normal");
        doc.setFontSize(9);
        doc.setTextColor(100, 116, 139); // slate-500
        doc.text("Generat des de Design Thinking Academy", margin, pageH - 10);

        doc.save(`informe-progres-${dateStr.replaceAll("/", "-")}.pdf`);
      };

      return (
        <div className="min-h-screen p-4 md:p-8 text-slate-900">
          <div className="max-w-5xl mx-auto">

            <header className="flex flex-col md:flex-row justify-between gap-4 mb-8">
              <h1 className="text-3xl font-black text-indigo-700">
                Design Thinking Academy
              </h1>

              <div className="bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex items-center gap-3">
                <div>
                  <div className="text-sm font-bold text-slate-500 uppercase tracking-wider">
                    ProgrÃ©s: {progressPercent}%
                  </div>
                  <div className="w-32 bg-slate-100 h-3 rounded-full overflow-hidden mt-2">
                    <div
                      className="h-full bg-indigo-600 transition-all"
                      style={{ width: `${progressPercent}%` }}
                    ></div>
                  </div>
                </div>

                {/* âœ… BotÃ³ PDF */}
                <button
                  onClick={downloadPDF}
                  className="px-4 py-2 rounded-xl bg-indigo-600 text-white font-bold text-sm shadow-sm hover:bg-indigo-700 transition-all"
                >
                  Descarregar PDF
                </button>
              </div>
            </header>

            <nav className="flex gap-2 mb-6 overflow-x-auto pb-2 no-scrollbar">
              {ACADEMY_DATA.map(phase => (
                <button
                  key={phase.id}
                  onClick={() => setActiveTab(phase.id)}
                  className={`px-4 py-2 rounded-lg font-bold whitespace-nowrap border-2 transition-all ${
                    activeTab === phase.id
                      ? "bg-indigo-600 border-indigo-600 text-white shadow-md"
                      : "bg-white border-transparent text-slate-500 hover:bg-slate-100"
                  }`}
                >
                  {phase.title.split(": ")[1]}
                </button>
              ))}
            </nav>

            {/* âœ… Mantinc el teu main, i hi afegeixo la columna de Resum de fase */}
            <main className="bg-white rounded-2xl p-6 md:p-8 shadow-lg border border-slate-100">
              <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">

                {/* COLUMNA ESQUERRA (exactament el que ja tens) */}
                <section className="lg:col-span-2">
                  <div className="flex flex-col md:flex-row justify-between items-start gap-4 mb-8">
                    <div>
                      <h2 className="text-3xl font-black text-slate-800 mb-2">
                        {activePhase.title}
                      </h2>
                      <p className="text-slate-500 text-lg leading-relaxed max-w-2xl">
                        {activePhase.description}
                      </p>
                    </div>

                    <button
                      onClick={() => copyToClipboard(activePhase.videoUrl, activePhase.id)}
                      className={`px-4 py-2 rounded-xl border-2 font-bold text-sm transition-all ${
                        copiedId === activePhase.id
                          ? "bg-green-100 border-green-500 text-green-700"
                          : "bg-slate-50 border-slate-200 text-slate-600 hover:bg-white hover:border-indigo-300"
                      }`}
                    >
                      {copiedId === activePhase.id ? "âœ“ Copiat!" : "Copiar URL VÃ­deo"}
                    </button>
                  </div>

                  <div className="grid gap-6">
                    {activePhase.tools.map(tool => (
                      <div
                        key={tool.id}
                        className={`p-6 rounded-2xl border-2 transition-all ${
                          completedTools.includes(tool.id)
                            ? "bg-green-50 border-green-200 shadow-inner"
                            : "bg-white border-slate-100 hover:border-indigo-100 shadow-sm"
                        }`}
                      >
                        <div className="flex justify-between items-center gap-4">
                          <div className="flex-1">
                            <h3 className="font-bold text-xl mb-1">
                              {tool.name}
                            </h3>
                            <p className="text-sm text-slate-500 mb-4 italic font-medium">
                              {tool.desc}
                            </p>
                            <div className="bg-white/50 p-4 rounded-xl text-slate-700 border border-slate-100/50">
                              {tool.content}
                            </div>
                          </div>

                          <button
                            onClick={() => toggleTool(tool.id)}
                            className={`w-12 h-12 shrink-0 rounded-full flex items-center justify-center font-bold text-2xl transition-all ${
                              completedTools.includes(tool.id)
                                ? "bg-green-500 text-white"
                                : "bg-indigo-100 text-indigo-600 hover:bg-indigo-600 hover:text-white"
                            }`}
                          >
                            {completedTools.includes(tool.id) ? "âœ“" : "+"}
                          </button>
                        </div>
                      </div>
                    ))}
                  </div>
                </section>

                {/* COLUMNA DRETA (Resum de fase) */}
                <aside className="lg:col-span-1">
                  <div className="lg:sticky lg:top-6 space-y-4">

                    <div className="rounded-2xl border border-slate-200 bg-indigo-950 text-white p-5 shadow-sm">
                      <div className="font-black text-lg mb-3">Resum de fase</div>

                      <div className="text-sm text-indigo-100 mb-4">
                        {activePhase.title}
                      </div>

                      <div className="space-y-2">
                        {activePhase.tools.map(t => {
                          const ok = completedTools.includes(t.id);
                          return (
                            <div key={t.id} className="flex items-start gap-2">
                              <div
                                className={`mt-1 w-3 h-3 rounded-full border ${
                                  ok ? "bg-green-400 border-green-300" : "bg-transparent border-white/40"
                                }`}
                              ></div>
                              <div className={`text-sm ${ok ? "text-white" : "text-indigo-100"}`}>
                                {t.name}
                              </div>
                            </div>
                          );
                        })}
                      </div>

                      <div className="mt-5 pt-4 border-t border-white/15 text-sm text-indigo-100">
                        Pendents en aquesta fase:{" "}
                        <span className="font-bold text-white">
                          {activePhase.tools.filter(t => !completedTools.includes(t.id)).length}
                        </span>
                      </div>
                    </div>

                    <div className="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
                      <div className="text-sm font-black text-slate-800 mb-2">Tip</div>
                      <div className="text-sm text-slate-600">
                        Marca les eines a mesura que les completes. El PDF recull el progrÃ©s i les tasques pendents.
                      </div>
                    </div>

                  </div>
                </aside>

              </div>
            </main>

          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
